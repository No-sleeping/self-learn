# 一、定义

CDN，Content Delivery Network，基于内容的分布式分发网络。

那么什么是CDN服务？ 
  简单的说CDN就是让原本上海的浏览器要访问北京主站内容的请求转而由部署在上海或南京的缓存来受理，这样请求的数据只需经过一跳或有限的几跳就能到达请求端，有效利用带宽并且降低主站压力，对于电子商务网站和搜索引擎网站以及门户网站，CDN的合理应用显得尤为重要。

# 二、网络架构

CDN网络一般分为中心与边缘节点两部分，中心负责全局负载均衡管理与内容管理；

中心节点的功能如下： 

1. 随时监控边缘节点的健康状况（可用性，拥塞程度）； 
2. 根据边缘节点到请求端的距离，以及边缘节点的健康状况，按一定的策略重定向请求； 
3. 与客户主站进行数据同步。

<br/>

> 1.当用户点击网站页面上的内容URL，经过本地DNS系统解析，DNS系统会最终将域名的解析权交给CNAME指向的CDN专用DNS服务器。
> 
> 2.CDN的DNS服务器将CDN的全局负载均衡设备IP地址返回用户。
> 
> 3.用户向CDN的全局负载均衡设备发起内容URL访问请求。
> 
> 4.CDN全局负载均衡设备根据用户IP地址，以及用户请求的内容URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求。
> 
> 5.区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据包括：根据用户IP地址，判断哪一台服务器距用户最近；根据用户所请求的URL中携带的内容名称，判断哪一台服务器上有用户所需内容；查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。基于以上这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的IP地址。
> 
> 6.全局负载均衡设备把服务器的IP地址返回给用户。
> 
> 7.用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地。

<br/>

# 三、工作原理

<br/>

3.1 传统的未加缓存服务的访问过程：

> 1、用户向浏览器提供要访问的域名;
> 
> 2、浏览器调用域名解析函数库对域名进行解析，以得到此域名对应的IP地址;
> 
> 3、浏览器使用所得到的IP地址，域名的服务主机发出数据访问请求;
> 
> 4、浏览器根据域名主机返回的数据显示网页的内容。

3.2  CDN网络是在用户和服务器之间增加Cache层， 如何将用户的请求引导到Cache上获得源服务器的数据，主要是通过接管DNS实现，访问使用CDN缓存后的网站的过程:

> 1.用户向浏览器输入www.web.com这个域名，浏览器第一次发现本地没有dns缓存，则向网站的DNS服务器请求； 
> 
> 2.网站的DNS域名解析器设置了CNAME，指向了www.web.51cdn.com,请求指向了CDN网络中的智能DNS负载均衡系统； 
> 
> 3.智能DNS负载均衡系统解析域名，把对用户响应速度最快的IP节点返回给用户； 
> 
> 4.用户向该IP节点（CDN服务器）发出请求； 
> 
> 5.由于是第一次访问，CDN服务器会向原web站点请求，并缓存内容； 
> 
> 6.请求结果发给用户。

<br/>

# 四、 特点

1. 本地Cache加速 提高了企业站点(尤其含有大量图片和静态页面站点)的访问速度，并大大提高以上性质站点的稳定性
2. 镜像服务 消除了不同运营商之间互联的瓶颈造成的影响，实现了跨运营商的网络加速，保证不同网络中的用户都能得到良好的访问质量。
3. 远程加速 远程访问用户根据DNS负载均衡技术智能自动选择Cache服务器，选择最快的Cache服务器，加快远程访问的速度
4. 带宽优化 自动生成服务器的远程Mirror（镜像）cache服务器，远程用户访问时从cache服务器上读取数据，减少远程访问的带宽、分担网络流量、减轻原站点WEB服务器负载等功能。
5. 集群抗攻击 广泛分布的CDN节点加上节点之间的智能冗余机制，可以有效地预防黑客入侵以及降低各种D.D.o.S攻击对网站的影响，同时保证较好的服务质量 。
国内较为有名的CDN服务商有思必达、蓝汛。

<br/>

<br/>

---

参考：

https://blog.csdn.net/wxl1555/article/details/52736498

https://blog.csdn.net/xixihahalelehehe/article/details/78604469

https://cloud.tencent.com/developer/article/1114835?from=15425&areaSource=102001.1&traceId=NzL933ajib1IGxYmybnVY  （A记录和CNAME记录的区别）
